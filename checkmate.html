<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Checkmate Challenge</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chessboardjs@1.0.0/css/chessboard.min.css">
<script src="https://cdn.jsdelivr.net/npm/chess.js@1.0.0/chess.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chessboardjs@1.0.0/js/chessboard.min.js"></script>

<style>
body { background:#161512; color:white; text-align:center; font-family:sans-serif; }
#board { width: 320px; margin:auto; margin-top:20px; }
button { padding:10px 20px; margin-top:10px; border:none; border-radius:6px; background:#dbac16; color:black; font-weight:bold; cursor:pointer; }
</style>
</head>
<body>

<h2>ðŸ”¥ Checkmate Challenge</h2>
<div id="board"></div>
<button onclick="generatePuzzle()">Nouveau Puzzle</button>

<script src="https://cdn.jsdelivr.net/gh/niklasf/stockfish.js/stockfish.js"></script>
<script>
let board = null;
let game = new Chess();
let stockfish = Stockfish(); // moteur WebAssembly
let solutionMoves = [];
let moveIndex = 0;

// Afficher Ã©chiquier
board = Chessboard('board', {draggable:true, position:'start', onDrop:onDrop});

// Liste de puzzles mate connus (FEN + solution)
const puzzles = [
    {fen:"8/8/8/8/8/6k1/5Q2/5K2 w - - 0 1", solution:["f2f6"]}, // Mate en 1
    {fen:"8/8/8/5Q2/8/6k1/8/5K2 w - - 0 1", solution:["f5f6"]},  // Mate en 1
    {fen:"8/8/5Q2/8/6k1/8/8/5K2 w - - 0 1", solution:["f6f7"]}, // Mate en 1
    {fen:"6k1/5pp1/8/8/8/8/5Q2/5K2 w - - 0 1", solution:["f2f7"]}, // Mate en 1
    {fen:"8/5k2/5pp1/8/8/8/5Q2/5K2 w - - 0 1", solution:["f2f7"]}, // Mate en 1
];

// GÃ©nÃ©rer un puzzle alÃ©atoire
function generatePuzzle() {
    moveIndex = 0;
    const puzzle = puzzles[Math.floor(Math.random()*puzzles.length)];
    game.load(puzzle.fen);
    board.position(game.fen());
    solutionMoves = puzzle.solution;
}

// VÃ©rifier le coup du joueur
function onDrop(source, target) {
    let move = game.move({from:source,to:target,promotion:'q'});
    if(move===null) return 'snapback';
    let userMove = move.from+move.to;

    if(userMove===solutionMoves[moveIndex]){
        moveIndex++;
        if(moveIndex>=solutionMoves.length){
            alert("âœ… Mate rÃ©ussi !");
            generatePuzzle();
        }
    } else {
        game.undo();
        return 'snapback';
    }
}

// Initialiser premier puzzle
generatePuzzle();
</script>

</body>
</html>

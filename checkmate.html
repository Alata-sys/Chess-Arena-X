<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Checkmate Challenge</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chessboardjs@1.0.0/css/chessboard.min.css">
<script src="https://cdn.jsdelivr.net/npm/chess.js@1.0.0/chess.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chessboardjs@1.0.0/js/chessboard.min.js"></script>
<style>
body { background:#161512; color:white; text-align:center; font-family:sans-serif; }
#board { width: 320px; margin:auto; margin-top:20px; }
button { padding:10px 20px; margin-top:10px; border:none; border-radius:6px; background:#dbac16; color:black; font-weight:bold; cursor:pointer; }
</style>
</head>
<body>
<h2>ðŸ”¥ Checkmate Challenge</h2>
<div id="board"></div>
<button onclick="loadPuzzle()">Nouveau Puzzle</button>

<script>
// Puzzle Lichess
const puzzleJSON = {
  "puzzle": {
    "solution":["c6d4","f3g3","d4e2","g1h2","e2g3"]
  },
  "game": {
    "pgn":"e4 e5 Nf3 Nc6 Bc4 Nf6 Nc3 Bc5 O-O d6 h3 h6 d3 g5 Nxg5 hxg5 Bxg5 Rg8 Bxf6 Qxf6 Nd5 Qg6 Qf3 f5 Nxc7+ Kd8 Nxa8 fxe4 dxe4"
  }
};

let board = null;
let game = new Chess();
let moveIndex = 0;

// Charger PGN
function loadPuzzle(){
    game.load_pgn(puzzleJSON.game.pgn);
    board.position(game.fen());
    moveIndex = 0;
}

// VÃ©rifier le coup du joueur
function onDrop(source, target){
    let move = game.move({from:source, to:target, promotion:'q'});
    if(move===null) return 'snapback';
    let userMove = move.from+move.to;

    if(userMove === puzzleJSON.puzzle.solution[moveIndex]){
        moveIndex++;
        if(moveIndex >= puzzleJSON.puzzle.solution.length){
            alert("âœ… Mate rÃ©ussi !");
            loadPuzzle(); // charger nouveau puzzle
        }
    } else {
        game.undo();
        return 'snapback';
    }
}

// Initialisation Ã©chiquier
board = Chessboard('board', {draggable:true, position:'start', onDrop:onDrop});
loadPuzzle();
</script>
</body>
</html>
